\section{Agent Interaction}

This section discusses the interaction of agents and crews within the system. The workflow involves multiple crews interacting with one another to ensure a coordinated and effective resolution plan is generated for the given emergency situation. 

The following is the entire flow diagram generated using Mermaid:

\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{Pictures/flow_diagram.png}
    \caption{Flow diagram showing the emergency workflow.}
    \label{fig:emergency_workflow}
\end{figure}

The following subsections discuss the workflow in detail, starting from the creation of the \textit{UserRequest} to the generation of the \textit{FinalPlan} output.

\subsection{Emergency Crew}
This subsection discusses the individual agents that make up the Emergency Crew. This detailed explanation is necessary due to the more complex interactions between the Emergency Crew and other crews, and it provides a deeper understanding of how these agents collaborate within the system.

\subsubsection{Distributor Agent}
The Distributor Agent serves as the central decision-making and coordination entity within the Emergency Crew. Upon receiving a \textit{UserRequest}, it distributes relevant information to the specialized crews according to the nature of the emergency. The Distributor Agent initiates queries and ensures appropriate crews are engaged.

\begin{itemize}
    \item \textbf{Firefighting Crew Interaction}: The Distributor Agent forwards information about fire-related emergencies to the Firefighting Crew.
    \item \textbf{Police Crew Interaction}: The Distributor Agent relays necessary details to the Police Crew.
    \item \textbf{Medical Crew Interaction}: The Distributor Agent checks whether injured people are involved. If there are injured people, the relevant information is sent to the Medical Crew. If no injuries are reported, the medical planning process is skipped, and the Receiver Agent moves forward with the plans of other crews.
\end{itemize}

\subsubsection{Receiver Agent}
The Receiver Agent, part of the Emergency Crew, is responsible for aggregating the plans generated by the Firefighting, Police, and Medical Crews. It combines these individual plans into a comprehensive \textit{FinalPlan} to address the emergency. The Receiver ensures that all plans are considered, including the acknowledgment of skipped steps (e.g., no medical plan).

\subsubsection{Philosopher Agent}
Before finalizing the response, the Receiver Agent evaluates the compiled \textit{FinalPlan} for potential ethical concerns. If ethical issues are detected, the Philosopher Agent is consulted to provide recommendations which are incorporated into the output. If no ethical issues are identified, the workflow bypasses the Philosopher Agent, and the \textit{FinalPlan} is finalized without additional consultation.

\subsection{Medical Crew}
The Medical Crew is tasked with addressing situations involving injured individuals. When injuries are present in the \textit{UserRequest} it sends relevant information to the Medical Crew, which then generates a \textit{MedicalPlan}. This plan is subsequently sent to the Receiver Agent for integration. If no injuries are detected, the Distributor bypasses the Medical Crew and acknowledges that no medical plan is required.

\subsection{Firefighting Crew}
The Firefighting Crew is responsible for handling fire-related details of the emergency response. Upon receiving information from the Distributor Agent, the Firefighting Crew processes the provided details and assesses the situation. Based on the information, it develops a \textit{FirefightingPlan}, which outlines the specific steps required to address the fire emergency effectively. Once the plan is complete, the Firefighting Crew sends the \textit{FirefightingPlan} to the Receiver Agent for integration into the comprehensive \textit{FinalPlan}.

\subsection{Police Crew}
The Police Crew manages the law enforcement aspects of the emergency. The Police Crew analyses the situation and reviews the details provided by the Distributor Agent. Using this information, the Police Crew creates a \textit{PolicePlan}, which specifies the actions required to address the law enforcement components of the emergency. After completing the plan, the Police Crew sends the \textit{PolicePlan} back to the Receiver Agent to be integrated into the \textit{FinalPlan}.

\subsection{Design Decisions}
\begin{itemize}
    \item We represented the Emergency Crew as two separate entities within the Mermaid diagram to maintain readability and ensure the flow remains as clear as possible. However, it is important to note that the Emergency Crew is considered a single unified entity in reality.
    \item We utilized two individual routers within our workflow, as specified in the assignment brief. The first router determines whether the Medical Crew is required based on the information provided in the \textit{UserRequest}. The second router assesses whether any of the individual crews, during the creation of their respective plans, detected ethical issues that need to be addressed. If ethical concerns are identified, the Philosopher Agent is consulted to resolve these issues. If no ethical concerns are detected, the Philosopher Agent is bypassed.
\end{itemize}
